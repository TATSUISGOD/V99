<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ã‚¿ãƒƒãƒ—RPG å®Œå…¨æœ€çµ‚ç‰ˆ</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{background:#111;color:#fff;font-family:sans-serif;text-align:center;margin:0;padding:20px}
button,input{font-size:14px;padding:8px 14px;margin:4px}
#tapBtn{font-size:26px;padding:28px 56px;margin-top:20px}
.hidden{display:none!important}
.boss{font-size:72px}
.player{font-size:60px}
.hp-bar{width:80%;height:20px;background:#444;margin:10px auto;border-radius:10px;overflow:hidden}
.hp{height:100%;background:red}
.overlay{position:fixed;inset:0;background:rgba(0,0,0,.9);display:flex;justify-content:center;align-items:center;z-index:999;font-size:18px;text-align:center;padding:20px}
</style>
</head>
<body>

<h1>ğŸ”¥ ã‚¿ãƒƒãƒ—RPG ğŸ”¥</h1>

<p>
ğŸ’° <span id="coin">0</span>
ğŸ’ <span id="dia">0</span>
â˜£ï¸ <span id="core">0</span>
âš” +<span id="atk">0</span>
</p>

<div class="player" id="player">ğŸ™‚</div>

<!-- ===== ã‚¬ãƒãƒ£ ===== -->
<button onclick="drawNormal(1)">ğŸ° é€šå¸¸</button>
<button onclick="drawNormal(10)">ğŸ° é€šå¸¸10é€£</button>
<button onclick="drawDia(1)">ğŸ’ ä¸Šä½</button>
<button onclick="drawDia(10)">ğŸ’ ä¸Šä½10é€£</button>
<button onclick="drawNew(1)">ğŸ’ æ–°ã‚¬ãƒãƒ£</button>
<button onclick="drawNew(10)">ğŸ’ æ–°ã‚¬ãƒãƒ£10é€£</button>
<button onclick="drawCore(1)">â˜£ï¸ ã‚³ã‚¢</button>
<button onclick="drawCore(10)">â˜£ï¸ ã‚³ã‚¢10é€£</button>
<button onclick="showDex()">ğŸ“– å›³é‘‘</button>

<hr>

<input id="diaNum" type="number" min="1" placeholder="ãƒ€ã‚¤ãƒ¤æ•°">
<button onclick="coinToDia()">ğŸ’°â†’ğŸ’</button>

<input id="coreNum" type="number" min="1" placeholder="ã‚³ã‚¢æ•°">
<button onclick="diaToCore()">ğŸ’â†’â˜£ï¸</button>

<hr>

<button onclick="startRush()">ğŸ”¥ ãƒœã‚¹ãƒ©ãƒƒã‚·ãƒ¥</button>

<hr>

<div id="select">
<h2>ãƒœã‚¹é¸æŠ</h2>

<!-- é€šå¸¸ -->
button onclick="startBattle('ã‚¹ãƒ©ã‚¤ãƒ ',100,'ğŸŸ¢',10)">ã‚¹ãƒ©ã‚¤ãƒ </button>
<button onclick="startBattle('ã‚´ãƒ–ãƒªãƒ³',300,'ğŸ‘º',30)">ã‚´ãƒ–ãƒªãƒ³</button>
<button onclick="startBattle('ã‚ªãƒ¼ã‚¯',800,'ğŸ‘¹',80)">ã‚ªãƒ¼ã‚¯</button>
<button onclick="startBattle('ãƒ‰ãƒ©ã‚´ãƒ³',3000,'ğŸ‰',300)">ãƒ‰ãƒ©ã‚´ãƒ³</button>

<hr><h3>ğŸ’ ãƒ€ã‚¤ãƒ¤ãƒœã‚¹</h3>
<button onclick="startBattle('é’æ™¶ã‚¹ãƒ©ã‚¤ãƒ (ãƒ€ã‚¤ãƒ¤ã‚­ãƒ£ãƒ©)',1500,'ğŸ’',0,1,)">é’æ™¶ã‚¹ãƒ©ã‚¤ãƒ </button>
<button onclick="startBattle('çµæ™¶ã‚´ãƒ–ãƒªãƒ³(ãƒ€ã‚¤ãƒ¤ã‚­ãƒ£ãƒ©)',4000,'ğŸ’',0,2)">çµæ™¶ã‚´ãƒ–ãƒªãƒ³</button>
<button onclick="startBattle('å®çŸ³ã‚ªãƒ¼ã‚¯(ãƒ€ã‚¤ãƒ¤ã‚­ãƒ£ãƒ©)',12000,'ğŸ’',0,3)">å®çŸ³ã‚ªãƒ¼ã‚¯</button>
<button onclick="startBattle('è¼ç«œ(ãƒ€ã‚¤ãƒ¤ã‚­ãƒ£ãƒ©)',40000,'ğŸ’',0,5)">è¼ç«œ</button>
<button onclick="startBattle('ç¥æ™¶ç«œ(ãƒ€ã‚¤ãƒ¤ã‚­ãƒ£ãƒ©)',120000,'ğŸ’',0,10)">ç¥æ™¶ç«œ</button>

<button onclick="startBattle('è¼çŸ³ã®é¨å£«(ãƒ€ã‚¤ãƒ¤ã‚­ãƒ£ãƒ©)',150000,'ğŸ’',0,15'">è¼çŸ³ã®é¨å£«</button>
<button onclick="startBattle('è’¼æ™¶ãƒ‰ãƒ©ã‚´ãƒ³(ãƒ€ã‚¤ãƒ¤ã‚­ãƒ£ãƒ©)',800000,'ğŸ’ ',0,50'">è’¼æ™¶ãƒ‰ãƒ©ã‚´ãƒ³</button>
<button onclick="startBattle('ç‹å† ç¥ç«œ(ãƒ€ã‚¤ãƒ¤ã‚­ãƒ£ãƒ©)',1500000,'ğŸ‘‘',0,70'">ç‹å† ç¥ç«œ</button>


<hr><h3>ğŸ’€ è¶…é«˜HPãƒœã‚¹</h3>
<button onclick="startBattle('è™šç„¡ã®ã‚¹ãƒ©ã‚¤ãƒ ',500000,'âš«',5000)">è™šç„¡ã®ã‚¹ãƒ©ã‚¤ãƒ </button>
<button onclick="startBattle('ç ´å£Šã‚´ãƒ–ãƒªãƒ³',1200000,'ğŸ’¥',12000)">ç ´å£Šã‚´ãƒ–ãƒªãƒ³</button>
<button onclick="startBattle('ç‹‚æˆ¦å£«ã‚ªãƒ¼ã‚¯',3000000,'ğŸ”¥',35000)">ç‹‚æˆ¦å£«ã‚ªãƒ¼ã‚¯</button>
<button onclick="startBattle('ç½å„ãƒ‰ãƒ©ã‚´ãƒ³',8000000,'ğŸ‰ğŸ”¥',120000)">ç½å„ãƒ‰ãƒ©ã‚´ãƒ³</button>
<button onclick="startBattle('å •å¤©ç¥ç«œ',20000000,'ğŸ˜ˆğŸ²',300000)">å •å¤©ç¥ç«œ</button>
<button onclick="startBattle('è™šç„¡ã®ã‚´ãƒ–ãƒªãƒ³',35000000,'âš«',400000)">è™šç„¡ã®ã‚´ãƒ–ãƒªãƒ³</button>
<button onclick="startBattle('ç ´æ»…ã‚ªãƒ¼ã‚¯',50000000,'ğŸ’¥',600000)">ç ´æ»…ã‚ªãƒ¼ã‚¯</button>
<button onclick="startBattle('çµ‚ç„‰ãƒ‰ãƒ©ã‚´ãƒ³',70000000,'ğŸ‰',900000)">çµ‚ç„‰ãƒ‰ãƒ©ã‚´ãƒ³</button>
<button onclick="startBattle('å •è½ç¥ç«œ',100000000,'ğŸ²',1300000)">å •è½ç¥ç«œ</button>
<button onclick="startBattle('æ·±æ·µã®ã‚¹ãƒ©ã‚¤ãƒ ',140000000,'âš«',1800000)">æ·±æ·µã®ã‚¹ãƒ©ã‚¤ãƒ </button>
<button onclick="startBattle('å¥ˆè½ã‚´ãƒ–ãƒªãƒ³',200000000,'ğŸ‘¿',2500000)">å¥ˆè½ã‚´ãƒ–ãƒªãƒ³</button>
<button onclick="startBattle('å†¥ç•Œã‚ªãƒ¼ã‚¯',280000000,'ğŸ‘¿',3500000)">å†¥ç•Œã‚ªãƒ¼ã‚¯</button>
<button onclick="startBattle('ç ´å£Šç¥ãƒ‰ãƒ©ã‚´ãƒ³',400000000,'ğŸ‰ğŸ”¥',5000000)">ç ´å£Šç¥ãƒ‰ãƒ©ã‚´ãƒ³</button>
<button onclick="startBattle('ç¥æ®ºã—ã®ç«œ',600000000,'ğŸ²âœ¨',8000000)">ç¥æ®ºã—ã®ç«œ</button>
<button onclick="startBattle('è™šç©ºã®ç¥ç«œ',900000000,'â˜ ï¸',12000000)">è™šç©ºã®ç¥ç«œ</button>
<button onclick="startBattle('çµ‚æœ«ã®ã‚¹ãƒ©ã‚¤ãƒ ',1300000000,'â˜ ï¸',18000000)">çµ‚æœ«ã®ã‚¹ãƒ©ã‚¤ãƒ </button>
<button onclick="startBattle('çµ¶æœ›ã‚´ãƒ–ãƒªãƒ³',1800000000,'â˜ ï¸',25000000)">çµ¶æœ›ã‚´ãƒ–ãƒªãƒ³</button>
<button onclick="startBattle('æ»…ç•Œã‚ªãƒ¼ã‚¯',2500000000,'â˜ ï¸',35000000)">æ»…ç•Œã‚ªãƒ¼ã‚¯</button>
<button onclick="startBattle('ç½ç¦ç¥ç«œ',3500000000,'â˜ ï¸',50000000)">ç½ç¦ç¥ç«œ</button>
<button onclick="startBattle('ä¸–ç•Œã‚’å–°ã‚‰ã†ç«œ',5000000000,'â˜ ï¸',80000000)">ä¸–ç•Œã‚’å–°ã‚‰ã†ç«œ

</div>

<div id="game" class="hidden">
<h2 id="bossName"></h2>
<div class="boss" id="bossIcon"></div>
<div class="hp-bar"><div class="hp" id="hp"></div></div>
<p>HP: <span id="hpText"></span></p>
<p id="timer"></p>
<button id="tapBtn" onclick="tap()">ã‚¿ãƒƒãƒ—ï¼</button>
</div>

<div id="overlay" class="overlay hidden" onclick="overlay.classList.add('hidden')"></div>

<script>
/* ===== DOM ===== */
const coinEl=coin=document.getElementById("coin");
const diaEl=document.getElementById("dia");
const coreEl=document.getElementById("core");
const atkEl=document.getElementById("atk");
const player=document.getElementById("player");
const select=document.getElementById("select");
const game=document.getElementById("game");
const bossName=document.getElementById("bossName");
const bossIcon=document.getElementById("bossIcon");
const hp=document.getElementById("hp");
const hpText=document.getElementById("hpText");
const overlay=document.getElementById("overlay");
const timerEl=document.getElementById("timer");
const diaNum=document.getElementById("diaNum");
const coreNum=document.getElementById("coreNum");

/* ===== ãƒ‡ãƒ¼ã‚¿ ===== */
let coinVal=+localStorage.getItem("coin")||0;
let diaVal=+localStorage.getItem("dia")||0;
let coreVal=+localStorage.getItem("core")||0;
let atkBonus=+localStorage.getItem("atk")||0;
let dex=JSON.parse(localStorage.getItem("dex")||"{}");

/* ===== ä¿å­˜ ===== */
function save(){
localStorage.setItem("coin",coinVal);
localStorage.setItem("dia",diaVal);
localStorage.setItem("core",coreVal);
localStorage.setItem("atk",atkBonus);
localStorage.setItem("dex",JSON.stringify(dex));
coinEl.textContent=coinVal;
diaEl.textContent=diaVal;
coreEl.textContent=coreVal;
atkEl.textContent=atkBonus;
player.textContent=atkBonus>=1000?"ğŸ‘‘ğŸ”¥":atkBonus>=100?"ğŸ˜âœ¨":"ğŸ™‚";
}
save();

/* ===== ã‚¬ãƒãƒ£ ===== */
function roll(t){
let r=Math.random()*100,s=0;
for(const g of t){s+=g[1];if(r<s)return g;}
}

const normalT=[["R",50,1],["SR",30,3],["UR",15,10],["LR",5,30]];
const diaT=[["UR",60,20],["LR",40,60]];
const newT=[["DIVINE",50,100],["DIVINEâ…¡",33,100],["DIVINEâ…¢",17,1000]];
const coreT=[["ã‚¨ãƒ¡ãƒ©ãƒ«ãƒ‰",40,500],["ãƒ«ãƒ“ãƒ¼",35,600],["ãƒ—ãƒ©ãƒãƒŠ",25,700]];

function gain(g){
atkBonus+=g[2];
dex[g[0]]=(dex[g[0]]||0)+1;
save();
return `${g[0]} +${g[2]}`;
}
function show(m){overlay.innerHTML=m+"<br><small>(ã‚¿ãƒƒãƒ—ã§é–‰ã˜ã‚‹)</small>";overlay.classList.remove("hidden");}

function drawNormal(n){
if(coinVal<100*n)return;
coinVal-=100*n;
let r="";
for(let i=0;i<n;i++)r+=gain(roll(normalT))+"<br>";
show(r);
}
function drawDia(n){
if(diaVal<n)return;
diaVal-=n;
let r="";
for(let i=0;i<n;i++)r+=gain(roll(diaT))+"<br>";
show(r);
}
function drawNew(n){
if(diaVal<100*n)return;
diaVal-=100*n;
let r="";
for(let i=0;i<n;i++)r+=gain(roll(newT))+"<br>";
show(r);
}
function drawCore(n){
if(coreVal<n)return;
coreVal-=n;
let r="";
for(let i=0;i<n;i++)r+=gain(roll(coreT))+"<br>";
show(r);
}

/* ===== å¤‰æ› ===== */
function coinToDia(){
const n=+diaNum.value;
if(!n||coinVal<n*1000)return;
coinVal-=n*1000;
diaVal+=n;
save();
show(`ğŸ’ +${n}`);
}
function diaToCore(){
const n=+coreNum.value;
if(!n||diaVal<n*5)return;
diaVal-=n*5;
coreVal+=n;
save();
show(`â˜£ï¸ +${n}`);
}

/* ===== å›³é‘‘ ===== */
function showDex(){
let h="ğŸ“– å›³é‘‘<br>";
for(const k in dex)h+=`${k} Ã— ${dex[k]}<br>`;
show(h);
}

/* ===== ãƒãƒˆãƒ« ===== */
let bossHp=0,maxHp=0,reward=0,rewardDia=0;
let rush=false,rushEnd=0,rushCount=0,rushHp=3000;

function startBattle(n,h,i,c,d){
rush=false;
bossName.textContent=n;
bossIcon.textContent=i;
bossHp=maxHp=h;
reward=c;
rewardDia=d;
select.classList.add("hidden");
game.classList.remove("hidden");
updateHp();
}

function tap(){
bossHp-=1+atkBonus;
if(bossHp<=0){
if(rush){rushCount++;nextRush();}
else{
coinVal+=reward;
diaVal+=rewardDia;
save();
game.classList.add("hidden");
select.classList.remove("hidden");
show(`ğŸ‰ æ’ƒç ´ï¼<br>ğŸ’°+${reward} ğŸ’+${rewardDia}`);
}
}
updateHp();
}

function updateHp(){
hpText.textContent=Math.max(0,Math.ceil(bossHp));
hp.style.width=(bossHp/maxHp*100)+"%";
}

/* ===== ãƒœã‚¹ãƒ©ãƒƒã‚·ãƒ¥ ===== */
function startRush(){
rush=true;
rushCount=0;
rushHp=3000;
rushEnd=Date.now()+60000;
nextRush();
select.classList.add("hidden");
game.classList.remove("hidden");
}

function nextRush(){
bossHp=maxHp=rushHp;
bossName.textContent="ãƒ©ãƒƒã‚·ãƒ¥ãƒœã‚¹ "+(rushCount+1);
bossIcon.textContent="ğŸ”¥";
rushHp=Math.floor(rushHp*1.3);
updateHp();
}

setInterval(()=>{
if(!rush)return;
const t=Math.ceil((rushEnd-Date.now())/1000);
timerEl.textContent="æ®‹ã‚Š "+t+" ç§’";
if(t<=0){
rush=false;
coinVal+=rushCount*500;
save();
game.classList.add("hidden");
select.classList.remove("hidden");
show(`ğŸ”¥ ãƒ©ãƒƒã‚·ãƒ¥çµ‚äº†<br>è¨ä¼ ${rushCount}`);
}
},200);
</script>
</body>
</html>
